

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>A QGIS attribute table plugin to show empty and null shapes &mdash; GeomAttribute  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Changelog" href="changelog.html" />
    <link rel="prev" title="API" href="API.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> GeomAttribute
          

          
          </a>

          
            
            
              <div class="version">
                0.1.2a
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="geomAttribute.html">Geometry Attribute Table</a></li>
<li class="toctree-l1"><a class="reference internal" href="loadData.html">Load Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">A QGIS attribute table plugin to show empty and null shapes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#preamble">Preamble</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#background">Background</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#relational-datasets">Relational Datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#set">Set</a></li>
<li class="toctree-l4"><a class="reference internal" href="#relational-dataset">Relational Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#geospatial-dataset">Geospatial Dataset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#geometry-data-types">Geometry data types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#geometry-data-values">Geometry data values</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#empty">Empty</a></li>
<li class="toctree-l4"><a class="reference internal" href="#null">null</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#parsing-data-by-qgis-data-providers">Parsing data by QGIS data Providers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gis-centric-and-the-wall-of-mystery">GIS Centric And the Wall of Mystery</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qgis">QGIS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#qgis-history">QGIS history</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vector-datasets-within-qgis">Vector datasets within QGIS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#problem-definition">PROBLEM DEFINITION</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#parsing-of-null-and-empty-shapes-to-and-from-external-databases-by-qgis">PARSING OF NULL AND EMPTY SHAPES TO AND FROM EXTERNAL DATABASES BY QGIS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#qgis-data-providers">QGIS Data Providers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exposure-of-null-and-empty-shape-values-in-qgis">EXPOSURE OF NULL AND EMPTY SHAPE VALUES IN QGIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gis-professional-awareness">GIS PROFESSIONAL AWARENESS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#set-operations-in-microsoft-sql-or-postgis-can-produce-empty-geometry-values">Set operations in Microsoft SQL or PostGIS can produce empty geometry values</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inadvertently-creating-empty-geometries-within-qgis">Inadvertently Creating Empty Geometries within QGIS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#retrospective-incorporation-of-empty-and-null-values-into-software">Retrospective incorporation of empty and null values into Software</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-definition-of-null-and-empty-values-depends-on-context">The definition of Null and Empty Values depends on context</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#future-development">Future Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bibliography">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GeomAttribute</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>A QGIS attribute table plugin to show empty and null shapes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/concept.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="a-qgis-attribute-table-plugin-to-show-empty-and-null-shapes">
<span id="concept-page"></span><h1>A QGIS attribute table plugin to show empty and null shapes<a class="headerlink" href="#a-qgis-attribute-table-plugin-to-show-empty-and-null-shapes" title="Permalink to this headline">¶</a></h1>
<p><strong>DRAFT</strong></p>
<div class="section" id="preamble">
<h2>Preamble<a class="headerlink" href="#preamble" title="Permalink to this headline">¶</a></h2>
<p>I am in the closing stages of a MGIS at Penn State and needed a topic for capstone project.  What sort of topic?? I am gainfully employed as a GIS Officer at a local government bureau, but, my employer was not willing to offer a topic nor were they willing to offer open access to curious datasets.  I have a passion for maps, cartography and spatial analysis, but, previous attempts to combine my passion with requirements for academia often ended in a feeling of futility.  From my employment, I realised that my colleagues and I occasionally loose hours because some of our datasets were <strong>corrupted</strong> by <em>null</em> or empty geometries.  I also realised that I was blissfully ignorant of the concept of <em>null</em> and empty geometries as they were not included in my GIS education.  So, I wanted to learn a bit about <em>null</em> and empty geometries in the hope that I can be more capable in my employment and so that I can feed a curiosity.</p>
<p>The concept of a QGIS plugin that exposed <em>null</em> and empty shapes evolved quickly.  A plugin is tangible and deliverable as opposed to curiosity which is instinct and always expanding.  QGIS is the primary desktop GIS software where I work and I was keen to learn how to automate and develop QGIS for specific tasks.  In my GIS degree we had used Python to automate tasks in ArcMap, and, C# to make apps in ArcMap, but, we had not dabbled in QGIS.  So. this project was also an adventure in QGIS scripting.</p>
<p>What comes next?  From this project I have learnt that much of the GIS software and the GIS community is GIS centric.  After all, to create a new record in a dataset with either QGIS or ArcMap one creates the shape of a feature, and, subsequently populates the other attributes.  To work in reverse and create the shape of a feature as the last step in a workflow is not only not conventional, but, also not trivial.  But here’s the point, whenever I have to create geospatial records I am always given a list of attributes and the shape is the last attribute to be created, the other attributes are already known and are re-entered.  Furthermore, most of the major desktop GIS packages report set operations between datasets differently to established database conventions.  I would like to work towards making QGIS and other software packages less GIS centric so that geospatial datasets become more ubiquitous and more open to other professional communities! To become less GIS centric you need to embrace the <em>null</em> and exploit the empty.</p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>A dataset is a collection of records, where each record has a defined number of elements and the data type of each
element is also defined.  The elements are commonly referred to as attributes.  For example, a dataset of street names
may consist of records have the attribute heading <em>“Name”</em> of type variable character and the character heading
<em>“Street Type”</em> of type street type.  In this example, street types may consist of the values
<em>(‘Lane’, ‘Road’, ‘Street’, ‘’)</em>.  The first three of the values <em>‘Lane’</em>, <em>‘Road’</em> and <em>‘Street’</em> are obvious – but what about
the last value of <em>‘’</em>?  <strong>‘’ is a deliberate empty set of character values!</strong>  In our world there are many streets that
have no type, and, indeed there are many that have no name.  Here, the use of an empty set of characters, or ‘’,
indicates that the Street Type attribute has no type, not that the type is unknown (null).</p>
<p>Geospatial datasets contain one or more values that refer to a location on earth.  For the majority of geospatial
datasets, the location consists of one or more points, lines and/or polygons that are referenced to a coordinate system
that is a projection of the earth’s surface.</p>
<p>For the purposes of this project, any dataset element type that stores the geospatial shape with respect to a referenced coordinate system is referred to as a geometry.  Any empty geometry element is simply a geometry that doesn’t have a shape.</p>
<p>In many enterprises geospatial datasets are contained within enterprise databases where frequently the same brand of enterprise database is used elsewhere within the same enterprise to contain non-spatial datasets.  For example, a local government office may use one or more MicroSoft SQL Server installations (MS SQL) as a dataset repository for: a content management system; a customer relationship management system; a land management system; an asset management system; and, a GIS system.</p>
<p>QGIS <a class="reference internal" href="#id39" id="id1">[3]</a> is a computer program that among other things is used to view, create and edit the geometry elements within geospatial datasets.  For many dataformats QGIS  QGIS does not: Pass null and empty geometry elements equivalently for different data storage formats; does not show directly show which records within a dataset have <em>null</em> or empty geometry elements; and, does not always process null and empty geometry elements as specified by standards.</p>
<p>This project aims to create a QGIS plugin that illuminates null and empty geometry elements in geospatial datasets.</p>
</div>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<div class="section" id="relational-datasets">
<h3>Relational Datasets<a class="headerlink" href="#relational-datasets" title="Permalink to this headline">¶</a></h3>
<div class="section" id="set">
<h4>Set<a class="headerlink" href="#set" title="Permalink to this headline">¶</a></h4>
<p>A set is a collection of distinct objects.  For example, a box of apples is a set of apples, and, the set of countries in North America consists of Canada,  United States of America, and, Mexico.  By convention, sets are symbolized by enclosing within curly brackets.  Hence:</p>
<div class="math notranslate nohighlight">
\[North\ American\ Countries = \{Canada, United\ States\ of\ America, Mexico\}\]</div>
<p>A dataset is any set where each element is restricted to one data type and where each element belongs to the same universal set.</p>
</div>
<div class="section" id="relational-dataset">
<h4>Relational Dataset<a class="headerlink" href="#relational-dataset" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt>A relational dataset is a collection of sets where:</dt>
<dd><ol class="first last arabic simple">
<li>The number of objects (elements) in each set is the same.</li>
<li>A one to one relationship exists between elements of different sets.</li>
</ol>
</dd>
</dl>
<p>An example relational dataset showing the country name, country abbreviation and country population for the countries in North America is shown in <a class="reference internal" href="#tablena-simple"><span class="std std-numref">Table 2</span></a>.  This relational dataset comprises of the three sets: a set of country names; a set of abbreviations; and, a set of country populations.  A one to one relationship exists between the elements for each of these three sets.  Hence, the country with the name of <em>Canada</em> has a one to one relationship with the country abbreviation <em>CAN</em> and the country population <em>3563000</em>.</p>
<span id="tablena-simple"></span><table border="1" class="colwidths-auto docutils" id="id40">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Example of a dataset of Countries in North America.</span><a class="headerlink" href="#id40" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Country Name</div>
<div class="line">(letters and spaces)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Abbreviation</div>
<div class="line">(upper case letters)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Population</div>
<div class="line">(integer)</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Canada</td>
<td>CAN</td>
<td>3563000</td>
</tr>
<tr class="row-odd"><td>United States of America</td>
<td>USA</td>
<td>32663000</td>
</tr>
<tr class="row-even"><td>Mexico</td>
<td>MEX</td>
<td>12458000</td>
</tr>
</tbody>
</table>
<p>Essential to any set is a definition or description of what type of objects can be a member.  For example, an apple which is a valid type of the set of fruit can’t be a member of a set of countries.  For any dataset, both the data type and additional constraints are often used together define the universal set.  For example, the data type for <em>Country Name</em> in <a class="reference internal" href="#tablena-simple"><span class="std std-numref">Table 2</span></a> is any combination of letters and spaces, whilst the data type for <em>Abbreviation</em> is any combination of 3 upper case letters.</p>
<p>Although a <em>relational dataset</em> consists of multiple sets of data where the elements of each set are related, it is ubiquitously referred to as a <strong>dataset</strong>.</p>
</div>
<div class="section" id="geospatial-dataset">
<h4>Geospatial Dataset<a class="headerlink" href="#geospatial-dataset" title="Permalink to this headline">¶</a></h4>
<p>A geospatial dataset refers to any dataset where one or more of the composite sets refer to a location on the earth’s surface.  This project is only concerned with those geospatial datasets where the location on the earth’s surface is represented by one or more points, lines or polygons that are located by coordinates and stored as vectors.  These points, lines and polygons are collectively referred to as shapes or geometries <a class="footnote-reference" href="#f5" id="id2">[5]</a>.  Datasets that include one or more sets of geospatial vectors are referred to as <em>Vector Datasets</em> by the GIS community.</p>
<p>A vector geospatial dataset is a subtype of geospatial dataset where the geospatial sets can be located graphically on the earths surface by the application of coordinates.  This project is only concerned with vector geospatial datasets.</p>
</div>
</div>
<div class="section" id="geometry-data-types">
<h3>Geometry data types<a class="headerlink" href="#geometry-data-types" title="Permalink to this headline">¶</a></h3>
<p>All datasets contain some restriction on the type of data each constituent set may contain.  From a software perspective, a restriction of type is essential for minimizing both the storage size of the dataset and the response time for a dataset query.  Analagous to specific data types for storage of numbers, text or dates there is one or more data types specifically used for the storage of geospatial geometries.  Similarly, just as there are often specific data types of signed and unsigned integers, float, and, decimal numbers there are also specific data types for different types of geometries, with the type often referring to how the geometry is constructed.</p>
<p>For any dataset software the geometry data types that are availabe for use can be shown schematically as a hierarchy like the one shown in <a class="reference internal" href="#figuregeomtypei"><span class="std std-numref">Fig. 1</span></a>.  Within this hierarchy, the possible data types are described by the labels in the boxes.  Essential to all such hierarchy’s, a set of data of a declared type may consist of any type below it on the hierarchy.  Hence, if a set of data has a declared type of <em>Geometry Collection</em> then any data element within it may consist of <em>Geometry Collection</em>, <em>Multi-Point</em>, “Multi-Curve*, <em>Multi-Line</em>, <em>Multi-Surface</em>, and, <em>Multi-Polygon</em>.  Similarly, if a set of data has a declared type of <em>Point</em> than it may not contain a <em>Polygon</em> nor a <em>Line</em>.</p>
<p>The single part constrained geometry subtypes in the lower part of <a class="reference internal" href="#figuregeomtypei"><span class="std std-numref">Fig. 1</span></a> are referred to as <em>Primitive Types</em> and must contain only one single part geometry per set element.  In contrast, the Multiple Part geometries may consist of one <em>or</em> many parts per feature.  For example, a feature of the <em>“Multi-Point”</em> geometry sub type may have one point, no points or multiple points. Another characteristic of the single part primitive types is that the <em>Line</em> and <em>Polygon</em> subtypes may only exist of straight line segments between coordinates.</p>
<div class="figure align-center" id="id41">
<span id="figuregeomtypei"></span><a class="reference internal image-reference" href="_images/geomTypeSQL.png"><img alt="_images/geomTypeSQL.png" src="_images/geomTypeSQL.png" style="width: 595.2px; height: 432.8px;" /></a>
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">GIS Geometry subtype hierarchy.  Adapted from <a class="reference internal" href="#iso19125-2" id="id3">[5]</a>.  The more conventional term <em>“LineString”</em> that is used in the QGIS API and <a class="reference internal" href="#iso19125-2" id="id4">[5]</a> is replaced here with <em>“Line”</em> for clarity.</span></p>
</div>
<p>In reality there may be many more geometry subtypes than the simplified hierarchy shown in <a class="reference internal" href="#figuregeomtypei"><span class="std std-numref">Fig. 1</span></a>.  For example, some common additional subtypes for datasets are created for sets of geometries that incorporate elevation data, or, for lines that are constructed from curves as opposed to straight line segments.</p>
<p>Many GIS data format standards, and, many GIS software have a geometry subtype hierarchy that is <strong>similar</strong> with <a class="reference internal" href="#figuregeomtypei"><span class="std std-numref">Fig. 1</span></a>.  Within a GIS dataset, geometry objects there are several geometry subtypes, with the main ones without elevation are shown in <a class="reference internal" href="#figuregeomtypei"><span class="std std-numref">Fig. 1</span></a>.  Schematically, this hierarchy of geometry subtypes is replicated by the <a class="reference external" href="https://qgis.org/api/classQgsAbstractGeometry.html">inheritance diagram for QgsAbstractGeometry</a> <a class="reference internal" href="#qgsabstractgeometry" id="id5">[12]</a>.</p>
</div>
<div class="section" id="geometry-data-values">
<h3>Geometry data values<a class="headerlink" href="#geometry-data-values" title="Permalink to this headline">¶</a></h3>
<p>For any data type there exists a universal set of valid values.  For example, a set of birthday dates must be restricted to valid dates.  For example, a birthday on the 30th of February is not valid as the 30th of February is not part of the universal set of dates.  Similarly, a valid geometry needs to be located within the boundaries of the coordinate system that it is referenced to.  <strong>Empty</strong> and <strong>null</strong> are two values that may be part of any set of data and could be fairly described as being:</p>
<ol class="arabic simple">
<li>Controversial</li>
<li>Miss-understood</li>
<li>Best avoided</li>
</ol>
<div class="section" id="empty">
<h4>Empty<a class="headerlink" href="#empty" title="Permalink to this headline">¶</a></h4>
<p>A box of apples can be described as a set of apples.  A empty Apple box is an empty set of apples.  An empty geometry element is a geometry that has no coordinates.  Whether an empty element is a valid member of a set depends on the context.  For example, if a study of chickens hatching from eggs recorded the date that each chicken hatches for a set of 10 eggs than the hatch date element is of the hatch date set is empty before the chicken hatches.  It is <em>known</em> that the chicken has not hatched.</p>
<p>All empty sets including an empty geometry value are place holders for when it is <em>known</em> that an element does not exist <a class="reference internal" href="#ogc2010" id="id6">[18]</a>.  For example, consider the intersection of the Blue Crosses and the Red Circles with the two squares shown in <a class="reference internal" href="#figuresquarepoint"><span class="std std-numref">Fig. 2</span></a>.  Both of the Blue Crosses B1 and B2 intersect the Left square, and, the Blue Cross B3 intersects the Right square.  The intersections of the Squares and Blue Crosses, and the Squares with Red Circles are summarized by the datasets shown in <a class="reference internal" href="#tableiiia"><span class="std std-numref">Table 3</span></a> and <a class="reference internal" href="#tableiiib"><span class="std std-numref">Table 4</span></a>.  As shown in  <a class="reference internal" href="#tableiiia"><span class="std std-numref">Table 3</span></a> the <em>Left Square</em> intersects with the <em>Blue Crosses</em> <em>B1</em> and <em>B2</em> which are represented as a subset <em>{B1, B2}</em>.  Similarly, it is reported in <a class="reference internal" href="#tableiiib"><span class="std std-numref">Table 4</span></a> that the <em>Left square</em> intersects the subset of <em>Red Circles</em> <em>{R1}</em>.  In contrast, also in <a class="reference internal" href="#tableiiib"><span class="std std-numref">Table 4</span></a> it is shown that the <em>Left square</em> does not intersect with any <em>Red Circles</em> as shown by the empty set <em>{ }</em>.  Here the empty set <em>{ }</em> shows that it is known that no intersection occurs.  The reporting of those combinations where intersections are known to not occur as shown  <a class="reference internal" href="#tableiiib"><span class="std std-numref">Table 4</span></a> follows the convention used by most SQL type relational databases for all set intersections regardless of whether they are geospatial or not.  In contrast, the convention for many GIS desktop software including QGIS and ArcGIS is to only show those combinations where intersections are known to occur (are True), hence, <a class="reference internal" href="#tableiiib"><span class="std std-numref">Table 4</span></a> is reported as <a class="reference internal" href="#tableiiic"><span class="std std-numref">Table 5</span></a> by QGIS.</p>
<div class="figure align-center" id="id42">
<span id="figuresquarepoint"></span><a class="reference internal image-reference" href="_images/squaresAndPoints.png"><img alt="_images/squaresAndPoints.png" src="_images/squaresAndPoints.png" style="width: 358.0px; height: 198.5px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">The location of blue crosses and red circles in the “Left Square” and the “Right Square”.</span></p>
</div>
<span id="tableiiia"></span><table border="1" class="colwidths-auto docutils" id="id43">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">The intersection of the the <em>Squares</em> and the <em>Blue Crosses</em>.</span><a class="headerlink" href="#id43" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Square</th>
<th class="head">Blue Crosses</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Left square</td>
<td>{B1, B2}</td>
</tr>
<tr class="row-odd"><td>Right square</td>
<td>{B3}</td>
</tr>
</tbody>
</table>
<span id="tableiiib"></span><table border="1" class="colwidths-auto docutils" id="id44">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">The intersection of the the <em>Squares</em> and the <em>Red Circles</em>.</span><a class="headerlink" href="#id44" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Square</th>
<th class="head">Red Circles</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Left square</td>
<td>{R1}</td>
</tr>
<tr class="row-odd"><td>Right square</td>
<td>{  }</td>
</tr>
</tbody>
</table>
<span id="tableiiic"></span><table border="1" class="colwidths-auto docutils" id="id45">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">The intersection of the the <em>Squares</em> and the <em>Red Circles</em> as shown by QGIS.</span><a class="headerlink" href="#id45" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Square</th>
<th class="head">Red Circles</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Left square</td>
<td>{R1}</td>
</tr>
</tbody>
</table>
<p>The real utility of empty geometry values is realised when the intersection of all the squares and both types of points (<em>Red Circles</em> and <em>Blue Crosses</em>) are collated in one dataset as shown in <a class="reference internal" href="#tableiii"><span class="std std-numref">Table 6</span></a> as opposed to  <a class="reference internal" href="#tableiiid"><span class="std std-numref">Table 7</span></a>.  By using the empty set <em>{ }</em> as a place holder for the known non-intersection of <em>Red Circles</em> with the <em>Right square</em> the sets of <em>Blue Crosses</em> and <em>Red Circles</em> are maintained as seperate columns.  Although this approach is efficient and intuitive it is not suitable when there is a large number of point types as the number of columns has a linear relationship to the numbs of points.</p>
<span id="tableiii"></span><table border="1" class="colwidths-auto docutils" id="id46">
<caption><span class="caption-number">Table 6 </span><span class="caption-text">The intersection of all point types and the squares.  Note that the sets each point type are still maintained as individual columns.  This approach is not feasible for a large number of point types as there would be too many columns.</span><a class="headerlink" href="#id46" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head" rowspan="2">Square</th>
<th class="head" colspan="2">Point type</th>
</tr>
<tr class="row-even"><th class="head">Blue Crosses</th>
<th class="head">Red Circles</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>Left square</td>
<td>{B1, B2}</td>
<td>{R1}</td>
</tr>
<tr class="row-even"><td>Right square</td>
<td>{B3}</td>
<td>{ }</td>
</tr>
</tbody>
</table>
<span id="tableiiid"></span><table border="1" class="colwidths-auto docutils" id="id47">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">The intersection of all point types and the squares.</span><a class="headerlink" href="#id47" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Square</th>
<th class="head">Point type</th>
<th class="head">Geometry</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Left square</td>
<td>Blue Crosses</td>
<td>{B1, B2}</td>
</tr>
<tr class="row-odd"><td>Right square</td>
<td>Blue Crosses</td>
<td>{B3}</td>
</tr>
<tr class="row-even"><td>Left square</td>
<td>Red Circles</td>
<td>{R1}</td>
</tr>
</tbody>
</table>
<div class="section" id="datasets-with-multiple-geometry-sets">
<h5>Datasets with multiple geometry sets<a class="headerlink" href="#datasets-with-multiple-geometry-sets" title="Permalink to this headline">¶</a></h5>
<p>Much of the GIS community work with the restriction of a single geometry set for each dataset (a single geometry column within a table).  It is difficult to have multiple geometry attributes without also allowing empty geometry attributes.  Next, I will examine the advantages and disadvantages of multiple geometry attributes.</p>
<p>The fundamental advantage of multiple geometry attributes is they facilitate topology. Topology refers to how the constituent parts of a system are interrelated or arranged.  The location of points within squares shown schematically in <a class="reference internal" href="#figuresquarepoint"><span class="std std-numref">Fig. 2</span></a> is an example of topology as it shows how the points are related to squares.  <a class="reference internal" href="#tableiii"><span class="std std-numref">Table 6</span></a> shows the topological association of point type by square type, but, uses two geometry columns to do so.  <a class="reference internal" href="#tablev"><span class="std std-numref">Table 8</span></a> shows the same data as <a class="reference internal" href="#tableiii"><span class="std std-numref">Table 6</span></a> using only one geometry column.  Examination of <a class="reference internal" href="#tablev"><span class="std std-numref">Table 8</span></a> reveals that the relationship between a type of point (e.g. Blue Crosses) and the Square type (e.g. Left Square or Right Square) has to be reported as two separate relationships (two separate records) and a user is left with the task of mentally connecting these two relationships.  Clearly, without using multiple geometry columns showing topological relationships is less intuitive.</p>
<span id="tablev"></span><table border="1" class="colwidths-auto docutils" id="id48">
<caption><span class="caption-number">Table 8 </span><span class="caption-text">Another way to represent the data in <a class="reference internal" href="#tableiii"><span class="std std-numref">Table 6</span></a> that uses only one geometry column.</span><a class="headerlink" href="#id48" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Square</th>
<th class="head">Point type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Left square</td>
<td>Blue crosses <span class="math notranslate nohighlight">\(\{B1,\ B2\}\)</span></td>
</tr>
<tr class="row-odd"><td rowspan="2">Left square</td>
<td rowspan="2">Red circles <span class="math notranslate nohighlight">\(\{R1\}\)</span></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td>Right square</td>
<td>Blue crosses <span class="math notranslate nohighlight">\(\{B3\}\)</span></td>
</tr>
<tr class="row-even"><td rowspan="2">Red circles</td>
<td rowspan="2">red circles <span class="math notranslate nohighlight">\(\{Empty\}\)</span></td>
</tr>
<tr class="row-odd"></tr>
</tbody>
</table>
<p>The major disadvantage of multiple geometry columns is that they are not supported by many pieces of GIS software or GIS file formats.  For example, ArcGIS does not support multiple geometry columns in any capacity, QGIS treats each geometry column as an unrelated dataset, and, the ubiquitous shapefile can only contain one geometry column.  So, by adopting multiple geometry columns you are isolating yourself from a large portion of the GIS community.</p>
</div>
</div>
<div class="section" id="null">
<h4>null<a class="headerlink" href="#null" title="Permalink to this headline">¶</a></h4>
<p><strong>null</strong> is the most common value (element) recorded many disciplines and software formats for <em>unknown</em> data values <a class="footnote-reference" href="#f6" id="id7">[6]</a>.  For example, if a study of chickens hatching from eggs recorded the hatch date of each chicken hatching for a set of 10 eggs than the hatch date element of the hatch date set is <em>null</em> (unknown) if the hatch date was not recorded.  Strictly speaking a <em>null</em> hatch date can be any value from the universal set of hath dates including <em>Empty</em> allowing for eggs that never hatched.</p>
<p>The most useful feature of <em>null</em> values is that they enable incomplete datasets.  For example, consider the Blue Crosses dataset shown in <a class="reference internal" href="#tableiiie"><span class="std std-numref">Table 9</span></a> where the coordinates for B4 are unknown. Datasets like <a class="reference internal" href="#tableiiie"><span class="std std-numref">Table 9</span></a> can stem from requests to georeference existing datasets where the georeferencing is incomplete.</p>
<span id="tableiiie"></span><table border="1" class="colwidths-auto docutils" id="id49">
<caption><span class="caption-number">Table 9 </span><span class="caption-text">The age, size and coordinates for the Blue Crosses.</span><a class="headerlink" href="#id49" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Blue Cross</th>
<th class="head">Age (years)</th>
<th class="head">Size</th>
<th class="head">Coordinates</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>B1</td>
<td>2</td>
<td>Big</td>
<td>(1, 1)</td>
</tr>
<tr class="row-odd"><td>B2</td>
<td>2</td>
<td>Small</td>
<td>(2, 2)</td>
</tr>
<tr class="row-even"><td>B3</td>
<td>3</td>
<td>Small</td>
<td>(4, 2)</td>
</tr>
<tr class="row-odd"><td>B4</td>
<td>8</td>
<td>Big</td>
<td><em>null</em></td>
</tr>
</tbody>
</table>
<div class="section" id="using-joins-to-eliminate-null">
<h5>Using joins to eliminate null<a class="headerlink" href="#using-joins-to-eliminate-null" title="Permalink to this headline">¶</a></h5>
<p>Many GIS datasets do not allow <em>null</em> geometries.  Having a dataset constraint that prevents <em>null</em> geometries does not imply that the geometries are all known, it only means that the dataset can’t have a <em>null</em> geometry.  The prevention of <em>null</em> geometries without knowing all of the geometries is achieved by using multiple datasets that include a geometry only dataset that has a relationship with a non-geometry dataset as shown in <a class="reference internal" href="#figurejoinedcrosses"><span class="std std-numref">Fig. 3</span></a>.  The relationship is typically achieved by the use of a <strong>key</strong> that is used in all related datasets to distinguish each relationship across the datasets.  Joins refer the process of forming a new dataset from multiple datasets by the use of a relationship.  The dataset shown in <a class="reference internal" href="#tableiiie"><span class="std std-numref">Table 9</span></a> can be created from the datasets shown in <a class="reference internal" href="#figurejoinedcrosses"><span class="std std-numref">Fig. 3</span></a> by application of an <em>outer join</em>.</p>
<div class="figure align-center" id="id50">
<span id="figurejoinedcrosses"></span><a class="reference internal image-reference" href="_images/CrossesWithoutNull.png"><img alt="_images/CrossesWithoutNull.png" src="_images/CrossesWithoutNull.png" style="width: 514.5px; height: 131.6px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text"><a class="reference internal" href="#tableiiie"><span class="std std-numref">Table 9</span></a> presented as two separate datasets where <em>null</em> <em>Coordinates</em> data values are not permitted.  The <em>Blue Crosses</em> key is used to register relationships between the two datasets that is symbolised by the grey dashed lines.</span></p>
</div>
</div>
<div class="section" id="reasons-for-preventing-null-geometries">
<h5>Reasons for preventing null geometries<a class="headerlink" href="#reasons-for-preventing-null-geometries" title="Permalink to this headline">¶</a></h5>
<p>The reasons for preventing null geometries include: it’s keeps GIS feature creation simple: one can’t map <em>null</em>; they permit the geometry value to be a variable; and, it keeps logic based algorithms simple.</p>
<p>For QGIS and many desktop GIS systems, records are created by drawing the geometry and subsequently entering the other data values.  This geospatial geometry centered approach intuitively keeps the related computer programming simple in comparison to any approach that allows a user to enter any of the data values including the geometry in the sequence that they choose.</p>
<p>There is no accepted universal approach to mapping a <em>null</em> geometry.  It is obvious that if a geometry is <em>null</em> then using a defined symbol at a single location is a miss-representation.  There is active research into approaches for mapping the unknown.</p>
<p>The use of a geometry specific dataset enables geometry to be a variable.  For example, take the Blue Cross B1.  This Blue Cross may represent a boat in a sea.  Hence, at different points in time, B1 may have different coordinates (<a class="reference internal" href="#tableiiif"><span class="std std-numref">Table 10</span></a>).  Most geospatial datasets have geometries that are variable as our technology for recording and knowing location is improving.  For example, an allotment of land may be static as it is relative to reference points, but, the mapped location and hence the recorded geometry for the allotment of land will change as the location of the reference points is refined to a higher accuracy.  Whether a dataset owner should track changes to a geometry is a question that is beyond the scope of this discussion.</p>
<span id="tableiiif"></span><table border="1" class="colwidths-auto docutils" id="id51">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">The coordinates of the Blue Crosses for yesterday and today.</span><a class="headerlink" href="#id51" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head" rowspan="2">Blue Cross</th>
<th class="head" colspan="2">Coordinates</th>
</tr>
<tr class="row-even"><th class="head">Yesterday</th>
<th class="head">Today</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>B1</td>
<td>(1, 1)</td>
<td>(2, 2)</td>
</tr>
<tr class="row-even"><td>B2</td>
<td>(2, 2)</td>
<td>(1, 2)</td>
</tr>
<tr class="row-odd"><td>B3</td>
<td>(4, 2)</td>
<td>(4, 1)</td>
</tr>
</tbody>
</table>
<p>Whether a dataset allows <em>null</em> values or not directly affects the type of logic applied to the dataset for set operations.  Boolean logic, also referred to as two value logic, allows only for True or False answers to set operations.  Boolean logic has can’t be applied when the answer is unknown.  When <em>null</em> values are permitted, three value logic is required for set operations.  The intersection of the squares with the two subsets of blue crosses {B1, B2, B3} and {B1, B2, B3, B4} that are described in <a class="reference internal" href="#tableiiie"><span class="std std-numref">Table 9</span></a> is shown in <a class="reference internal" href="#tableiiig"><span class="std std-numref">Table 11</span></a>.  For {B1, B2} it is True that they intersect the Left square, whilst it is also True that {B3} does not intersect the same square, however, it is null (unknown) whether {B4} intersects the Left Square.  Compounding the implementation of Three value logic is the fact that different database platforms implement three value logic differently leading to widespread avoidance of three value logic regardless of whether the data type is geometry or something more generic like an integer.  In summary, even when <em>null</em> values are permitted in datasets, the records associated with them are typically excluded from set operations.</p>
<span id="tableiiig"></span><table border="1" class="colwidths-auto docutils" id="id52">
<caption><span class="caption-number">Table 11 </span><span class="caption-text">The intersection of the squares with the subsets {B1, B2, B3} and {B1, B2, B3, and B4} as shown in <a class="reference internal" href="#tableiiie"><span class="std std-numref">Table 9</span></a>.</span><a class="headerlink" href="#id52" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head" rowspan="3">Square</th>
<th class="head" colspan="2">Intersection with the subset</th>
</tr>
<tr class="row-even"><th class="head">{B1, B2, B3}</th>
<th class="head">{B1, B2, B3, B4}</th>
</tr>
<tr class="row-odd"><th class="head">Boolean logic</th>
<th class="head">Three value logic</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Left square</td>
<td>{B1, B2}</td>
<td>{B1, B2, null-B4}</td>
</tr>
<tr class="row-odd"><td>Right square</td>
<td>{B3}</td>
<td>{B3, null-B4}</td>
</tr>
</tbody>
</table>
<p>Although beyond the scope of this project, it is noted that although Boolean logic is applied the same in the majority of relational databases there is known diversity in the application for three value logic.</p>
</div>
<div class="section" id="reasons-for-allowing-null-geometries">
<h5>Reasons for allowing null geometries<a class="headerlink" href="#reasons-for-allowing-null-geometries" title="Permalink to this headline">¶</a></h5>
<p>Although the majority of GIS systems do not promote the use of null geometry data values, there are several reasons why they should be adopted: they force the adoption of geospatial datasets by enterprise databases; they illuminate the unknown; and, they facilitate a simpler dataset structure.</p>
<p>The forced adoption of geospatial datasets by enterprise databases is the most compelling reason to adopt null geometry values.  For example, consider a commercial database used for rates at a local government.  The current approach of most databases for rates is to mimic <a class="reference internal" href="#figurejoinedcrosses"><span class="std std-numref">Fig. 3</span></a> where the tables for the land registry are maintained within a land registry database, and, the tables for the georeferenced land allotments are in a GIS database and these databases are joined.  This approach facilitates bureaucracies where separate teams of people maintain each database, and, where the land registry database does not adopt spatial functionality as the data is located in a separate database.  Whilst using a separate GIS database allows the local government to develop a custom GIS system, it comes at a cost of minimal inbuilt spatial capability.</p>
<p>Allowing <em>null</em> has the potential to expose the unknown.  By exposing the unknown, it it is evident where further data capture is required, and, it is more likely that any spatial analysis will also establish the degree of dataset completeness.</p>
<p>A disadvantage of the lookup table approach is the requirement for the documentation of database schema for users to maintain the lookup key and to perform database queries that include spatial and non-spatial attributes.  Without lookup tables the database structure is simpler leading to fewer errors and fewer joins when constructing queries.</p>
</div>
</div>
</div>
<div class="section" id="parsing-data-by-qgis-data-providers">
<h3>Parsing data by QGIS data Providers<a class="headerlink" href="#parsing-data-by-qgis-data-providers" title="Permalink to this headline">¶</a></h3>
<p>QGIS parses data to and from many data formats without requiring importing or exporting to or from a common data format.  The intent of this data parsing is that a user may analyse data stored in different formats with a common user interface.  A key component of any GIS record is a geospatial geometry data type which could be stored in an infinite number of ways.  Fortunately, there are international standards <a class="reference internal" href="#iso19125-2" id="id8">[5]</a> that describe the geospatial geometry data type and subtypes, and, there is some consistency across most data formats.</p>
<p>Although different GIS data formats have <strong>similar</strong> geometry subtype hierarchy’s, they are not the same.  For example, many different SQL databases that adopt elements of ISO19125-2 <a class="reference internal" href="#iso19125-2" id="id9">[5]</a> including PostGis and MS SQL by default have a <em>Geometry</em> subtype <a class="footnote-reference" href="#f4" id="id10">[4]</a>. Consequently, without further constraints in their native environment one can choose any subtype shown in <a class="reference internal" href="#figuregeomtypei"><span class="std std-numref">Fig. 1</span></a> for any record.  In comparison, the <em>Geometry</em> subtype equivalent in the QGIS data type inheritance diagram <a class="reference internal" href="#qgsabstractgeometry" id="id11">[12]</a> has the title <em>“QgsAbstractGeometry”</em> where the <em>Abstract</em> keyword tell us that this datatype can’t be created by itself, only it’s children can be created.  To emphasize, parsing data for different data formats but maintaining a uniform user interface is a Pandora’s box when the data types or subtypes have different hierarchy’s of data subtypes.</p>
<p>With the understanding that different data formats have different geometry hierarchy’s it is expected that QGIS needs to make adjustments on the fly. This parsing is silent and without experience errors may be introduced into datasets.</p>
<span id="tablemultiline"></span><table border="1" class="colwidths-auto docutils" id="id53">
<caption><span class="caption-number">Table 12 </span><span class="caption-text">Feature geometry changes when exporting a QGIS Multi-Line memory layer.</span><a class="headerlink" href="#id53" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Original</th>
<th class="head">Geopackage</th>
<th class="head">Shapefile</th>
<th class="head">Spatialite</th>
<th class="head">PostGis</th>
<th class="head">MS SQL</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Multi-Line</td>
<td>Multi-Line</td>
<td>Multi-Line</td>
<td>Multi-Line</td>
<td>Multi-Line</td>
<td>Multi-Line</td>
</tr>
<tr class="row-odd"><td>Line</td>
<td><em>Multi-Line</em></td>
<td><em>Multi-Line</em></td>
<td><em>Multi-Line</em></td>
<td>Line</td>
<td>Line</td>
</tr>
<tr class="row-even"><td>Empty</td>
<td>Empty</td>
<td><em>null</em></td>
<td>Empty</td>
<td>Empty</td>
<td><em>null</em></td>
</tr>
<tr class="row-odd"><td><em>null</em></td>
<td>Empty</td>
<td><em>null</em></td>
<td>Empty</td>
<td><em>null</em></td>
<td><em>null</em></td>
</tr>
</tbody>
</table>
<p>For several dataproviders including QGIS memory layer, PostGIS and MicroSoft SQL Server QGIS employs a subtype hierarchy shown by <a class="reference internal" href="#figuregeomtypeii"><span class="std std-numref">Fig. 4</span></a>.  Hence for some dataproviders, by default, QGIS creates a new one part line in a dataset of the <em>“Multi-Line”</em> subtype as a Line and not a <em>“Multi-Line”</em>.  The insertion of a <em>“Line”</em> geometry subtype into a <em>“Multi-Line”</em> geometry subtype dataset is readily demonstrated by python script using the QGIS API:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layerMulti</span><span class="o">=</span><span class="n">QgsVectorLayer</span><span class="p">(</span><span class="s1">&#39;MultiLineString?crs=epsg:4326&amp;field=ID:string&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s2">&quot;memory&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">providerMulti</span><span class="o">=</span><span class="n">layerMulti</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recordWrite</span> <span class="o">=</span> <span class="n">QgsFeature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recordWrite</span><span class="o">.</span><span class="n">setAttributes</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recordWrite</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QgsGeometry</span><span class="o">.</span><span class="n">fromWkt</span><span class="p">(</span><span class="s1">&#39;LINESTRING (1 1, 6 1)&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">providerMulti</span><span class="o">.</span><span class="n">addFeature</span><span class="p">(</span><span class="n">recordWrite</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recordRead</span> <span class="o">=</span> <span class="n">layerMulti</span><span class="o">.</span><span class="n">getFeature</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">QgsWkbTypes</span><span class="o">.</span><span class="n">displayString</span><span class="p">(</span><span class="n">recordRead</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span><span class="o">.</span><span class="n">wkbType</span><span class="p">()))</span>
<span class="go">LineString</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">QgsWkbTypes</span><span class="o">.</span><span class="n">displayString</span><span class="p">(</span><span class="n">layerMulti</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span><span class="o">.</span><span class="n">wkbType</span><span class="p">()))</span>
<span class="go">MultiLineString</span>
</pre></div>
</div>
<p>More worringly, as shown in the next python script, the reverse is also possible.  One may add a feature with a <em>Multi-Line</em> geometry sub-type to a <em>Line</em> dataset.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layerSingle</span><span class="o">=</span><span class="n">QgsVectorLayer</span><span class="p">(</span><span class="s1">&#39;LineString?crs=epsg:4326&amp;field=ID:string&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s2">&quot;memory&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">providerSingle</span> <span class="o">=</span> <span class="n">layerSingle</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recordWrite</span> <span class="o">=</span> <span class="n">QgsFeature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recordWrite</span><span class="o">.</span><span class="n">setAttributes</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recordWrite</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QgsGeometry</span><span class="o">.</span><span class="n">fromWkt</span><span class="p">(</span><span class="s1">&#39;MULTILINESTRING ((1 1, 6 1))&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">providerSingle</span><span class="o">.</span><span class="n">addFeature</span><span class="p">(</span><span class="n">recordWrite</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recordRead</span> <span class="o">=</span> <span class="n">layerSingle</span><span class="o">.</span><span class="n">getFeature</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">QgsWkbTypes</span><span class="o">.</span><span class="n">displayString</span><span class="p">(</span><span class="n">recordRead</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span><span class="o">.</span><span class="n">wkbType</span><span class="p">()))</span>
<span class="go">MultiLineString</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">QgsWkbTypes</span><span class="o">.</span><span class="n">displayString</span><span class="p">(</span><span class="n">layerSingle</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span><span class="o">.</span><span class="n">wkbType</span><span class="p">()))</span>
<span class="go">LineString</span>
</pre></div>
</div>
<p>Fortunately with QGIS you can’t insert a <em>Point</em> into a <em>Line</em> dataset, or, otherwise mix geometry sub-types of different dimensionality.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layerSingle</span><span class="o">=</span><span class="n">QgsVectorLayer</span><span class="p">(</span><span class="s1">&#39;LineString?crs=epsg:4326&amp;field=ID:string&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s2">&quot;memory&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">providerSingle</span> <span class="o">=</span> <span class="n">layerSingle</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recordWrite</span> <span class="o">=</span> <span class="n">QgsFeature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recordWrite</span><span class="o">.</span><span class="n">setAttributes</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recordWrite</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QgsGeometry</span><span class="o">.</span><span class="n">fromWkt</span><span class="p">(</span><span class="s1">&#39;POINT (1 1)&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">providerSingle</span><span class="o">.</span><span class="n">addFeature</span><span class="p">(</span><span class="n">recordWrite</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="figure align-center" id="id54">
<span id="figuregeomtypeii"></span><a class="reference internal image-reference" href="_images/geomTypeQGIS.png"><img alt="_images/geomTypeQGIS.png" src="_images/geomTypeQGIS.png" style="width: 630.4000000000001px; height: 432.8px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">The Geometry subtype hierarchy employed by QGIS by default for several data providers.</span></p>
</div>
<p>QGIS mixes the primitive geometry types with the modern geometry types by default.  The data providers typically handle this well, but, the pre-scripted decisions can have consequences.</p>
<p>For example, by default QGIS will permit a user to add a Multi-line feature to a MicroSoft SQL database that only contains Line features.</p>
</div>
<div class="section" id="gis-centric-and-the-wall-of-mystery">
<h3>GIS Centric And the Wall of Mystery<a class="headerlink" href="#gis-centric-and-the-wall-of-mystery" title="Permalink to this headline">¶</a></h3>
<p>Many GIS software packages force the user to perform a selection whenever they perform a set operation like a union, intersection or difference.  The results of an intersection without a selection of the points and squares shown in <a class="reference internal" href="#figuresquarepoint"><span class="std std-numref">Fig. 2</span></a> includes those records that don’t intersect (<a class="reference internal" href="#tablev"><span class="std std-numref">Table 8</span></a>).  To achieve the more common output shown in <a class="reference internal" href="#tablevi"><span class="std std-numref">Table 13</span></a> a selection must be performed on the data to include only those records that do intersect.  Hence, the logic performed by most GIS software packages including ArcGIS and QGIS is: 1. Select those records where intersect is True; 2. Perform intersection.</p>
<span id="tablevi"></span><table border="1" class="colwidths-auto docutils" id="id55">
<caption><span class="caption-number">Table 13 </span><span class="caption-text">Another way to represent the data in 5 where records where no intersection occurs are also shown.</span><a class="headerlink" href="#id55" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Square</th>
<th class="head">Point type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Left square</td>
<td>Blue crosses <span class="math notranslate nohighlight">\(\{P1,\ P2\}\)</span></td>
</tr>
<tr class="row-odd"><td rowspan="2">Left square</td>
<td rowspan="2">Red circles <span class="math notranslate nohighlight">\(\{P3\}\)</span></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td>Right square</td>
<td>Blue crosses <span class="math notranslate nohighlight">\(\{P4\}\)</span></td>
</tr>
</tbody>
</table>
<p>Being forced to do a selection in addition to an intersection is an algorithmic solution that eliminates the need for empty geometry values.  Forcing a selection as part of a set operation introduces the assumption that records missing from the results are empty (e.g. do not intersect) and hence prohibits the ability to also record unknown (<em>null</em>) set operations.  Another problem of forced selection is that problem solving of erroneous set operations is hindered as one needs to undertake additional steps to confirm those records that were explicitly excluded by the forced selection.  For logic and critical thinking analysing the negative results can be more fruitful than analysing the positive results!</p>
</div>
<div class="section" id="qgis">
<h3>QGIS<a class="headerlink" href="#qgis" title="Permalink to this headline">¶</a></h3>
<p>QGIS is self-promoted as an “Open Source Geographic Information System” <a class="reference internal" href="#id39" id="id12">[3]</a>.  QGIS is used for creating, manipulating and publishing spatial data sets by many organisations.  Some organisations use QGIS to edit or create geometries for geospatial datasets within enterprise databases in their native format as no commercial software has this capability.  For example, <a class="reference external" href="http://www.smec.com/en_au/what-we-do/sectors/transport/pavement-management-systems">SMEC Pavement Management Software</a> uses a Microsoft SQL database to contain it’s pavement datasets.  QGIS can browse and edit the geometries contained within this dataset without importing or exporting any dataset.   In comparison, software like ArcMap requires a user to import, edit, then export the data to the SMEC Pavement Management Software even though both installation could have their data respective datasets within the same Microsoft SQL Server installation, and, both datasets are using the same datatype for the geometry values.
By intentional design and function, the majority of QGIS users use other software packages or software formats developed by other organisations to store geospatial datasets.  For example, the PostGIS, MS SQL and SpatiaLite databases, and, the esri shapefile format are all processed in their native format by QGIS.</p>
<div class="section" id="qgis-history">
<h4>QGIS history<a class="headerlink" href="#qgis-history" title="Permalink to this headline">¶</a></h4>
<p>QGIS was created by Gary Sherman in 2002 <a class="reference internal" href="#qgiscontributors" id="id13">[15]</a><a class="reference internal" href="#garysherman2011" id="id14">[21]</a>.  In 2007 it became a project of the Open Source Geospatial Foundation with version 1 being released in January 2009 <a class="reference internal" href="#qgiscontributors" id="id15">[15]</a>.  The version of QGIS used in this project, Version 3, was released in February 2018 <a class="reference internal" href="#qgiscontributors" id="id16">[15]</a>.  Version 2 of QGIS employed Python 2 for scripting and PyQT4 for the graphical user interface (GUI).  Version 3 of QGIS employs Python 3 for scripting and PyQT5 for the GUI.  QGIS version 3 is self-described as a “huge overhaul and cleanup” of QGIS version 2 <a class="reference internal" href="#qgischangelogv3" id="id17">[9]</a>.  Many of the python scripts configured for version 2 no longer work with version 3 with much of the legacy sub-version support dropped.</p>
</div>
<div class="section" id="vector-datasets-within-qgis">
<h4>Vector datasets within QGIS<a class="headerlink" href="#vector-datasets-within-qgis" title="Permalink to this headline">¶</a></h4>
<p>Within QGIS, the geometries for each record are contained within instances of QgsAbstractGeometry subclasses <a class="reference internal" href="#qgsgeometryclass" id="id18">[7]</a>.  The manner in which QGIS stores empty geometries is not inherited from the QgsAbstractGeometry superclass, but rather is determined for each subclass separately.  Although QGIS is capable to parse empty geometries for the majority of the QgsAbstractGeometry subclass there may be some that are unable to do so.</p>
<p>The variations in how QgsAbstractGeometry subclasses contain empty geometries is demonstrated in the following section by example.  Using the QGIS API, empty geometries for several geometry types can be instantiated by instantiating the relevant QgsAbstractGeometry subclass without a set of vertices.  For example, to test that a <code class="docutils literal notranslate"><span class="pre">QgsLineString()</span></code> is empty:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="n">QgsLineString</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">QgsLineString</span><span class="p">()</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Although empty geometries can be created for most geometry types with the QGIS API by instantiation without a set of vertices, it is not currently possible to instantiate an empty point geometry (<a class="reference internal" href="#tablevii"><span class="std std-numref">Table 14</span></a>). As demonstated below, the well known text representation of the call to instantiate an empty point reveals that QGIS is wrongly adding a vertex with the coordinates of <span class="math notranslate nohighlight">\((0\ 0)\)</span> <a class="reference internal" href="#qgspointbugreport2018" id="id19">[8]</a> <a class="footnote-reference" href="#f1" id="id20">[1]</a>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="n">QgsLineString</span><span class="p">,</span><span class="n">QgsPoint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">QgsLineString</span><span class="p">()</span><span class="o">.</span><span class="n">asWkt</span><span class="p">())</span>
<span class="go">LineString ()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">QgsPoint</span><span class="p">()</span><span class="o">.</span><span class="n">asWkt</span><span class="p">())</span>
<span class="go">Point (0 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">QgsPoint</span><span class="p">()</span><span class="o">.</span><span class="n">createEmptyWithSameType</span><span class="p">()</span><span class="o">.</span><span class="n">asWkt</span><span class="p">())</span>
<span class="go">Point (nan nan)</span>
</pre></div>
</div>
<span id="tablevii"></span><table border="1" class="colwidths-auto docutils" id="id56">
<caption><span class="caption-number">Table 14 </span><span class="caption-text">Testing whether an empty geometry has been created by the instantiation of various types of QgsAbstractGeometry subclasses using the python Console in QGIS 3.0.3.</span><a class="headerlink" href="#id56" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Input</th>
<th class="head">Output</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">QgsPoint().isEmpty()</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">False</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">QgsLineString().isEmpty()</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">True</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">QgsPolygon().isEmpty()</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">True</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">QgsGeometryCollection().isEmpty()</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">True</span></code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="problem-definition">
<h2>PROBLEM DEFINITION<a class="headerlink" href="#problem-definition" title="Permalink to this headline">¶</a></h2>
<p>The problems that this project intends to address are:</p>
<ol class="arabic simple">
<li>Null and empty shapes are parsed differently by different data providers in QGIS.</li>
<li>Within QGIS, there is no published plugin or output that shows records within a dataset that have null or empty geometry values.</li>
<li>Many GIS professionals do not anticipate or are aware of datasets that have null or empty geometries.</li>
<li>Empty geometry values were not included in the set of valid values in the original QGIS or GDAL specifications.</li>
</ol>
<div class="section" id="parsing-of-null-and-empty-shapes-to-and-from-external-databases-by-qgis">
<h3>PARSING OF NULL AND EMPTY SHAPES TO AND FROM EXTERNAL DATABASES BY QGIS<a class="headerlink" href="#parsing-of-null-and-empty-shapes-to-and-from-external-databases-by-qgis" title="Permalink to this headline">¶</a></h3>
<p>Using source specific data providers, QGIS processes data to and from third party databases without requiring constraints or additional tables in the third-party database.  Each data provider has been created independently and these do treat the same data values differently.  For example, as expected QGIS parses empty linestrings from PostGis databases as not null but it incorrectly parses empty linestrings from Microsoft SQL Server as null <a class="reference internal" href="#parseemptyfromsql" id="id21">[22]</a>.</p>
<div class="section" id="qgis-data-providers">
<h4>QGIS Data Providers<a class="headerlink" href="#qgis-data-providers" title="Permalink to this headline">¶</a></h4>
<p>A component of software that allows it to directly read data without conversion to a different data type, and, to write updates or new records to a dataset without exporting is called a data provider.   QGIS contains data providers for 18 different formats for which it can read from or write to in their native format <a class="reference internal" href="#qgsproviders2018" id="id22">[13]</a>.  Being open source, each of the data QGIS providers were created at different times for different purposes, are founded on different philosophies and have different levels of development.  Consequently, even when different database packages follow the same geospatial standards, equivalent shapes from those different database packages may be read as different shapes due to variations or errors between data providers.</p>
<p>Within this project it is anticipated that errors passing empty or null values from Microsoft SQL Server or PostGIS will be found.  Unfortunately, the C++ classes employed in the data type specific data providers <a class="reference internal" href="#qgsproviders2018" id="id23">[13]</a> are not exposed in the QGIS API which means that their function is not easily modified.</p>
<p>QGIS’s data providers that allow it to read or write in native format without need for additional constraints or data tables is a key feature that makes it popular in large organisations. By reading and writing in the native format, QGIS can edit or create geospatial data within an enterprise database that is configured for another piece of software and without importing and exporting.  In doing so QGIS has removed one of the barriers to integration of geospatial data within enterprise datasets.</p>
<p>In comparison to QGIS’s approach of editing the data in it’s native format, ESRI’s ArcMap requires a user to import into a geodatabase and undertake the editing there– even though the enterprise database and the geodatabase may be using the same database server <a class="reference internal" href="#arcgistutorialforempty" id="id24">[14]</a>.  ESRI’s approach often leads to a lookup table being used for geospatial data and then scripts run on those lookup tables to publish an integrated dataset.</p>
</div>
</div>
<div class="section" id="exposure-of-null-and-empty-shape-values-in-qgis">
<h3>EXPOSURE OF NULL AND EMPTY SHAPE VALUES IN QGIS<a class="headerlink" href="#exposure-of-null-and-empty-shape-values-in-qgis" title="Permalink to this headline">¶</a></h3>
<p>Within QGIS, without using custom expressions or scripts there is only limited exposure to null shapes, and, empty shapes.  Two locations within QGIS where you may find descriptive information of each record are the <em>“Attribute Table”</em> and the <em>“DB Manager”</em> plugin.</p>
<p>Without using expressions and creating new attributes, the “Attribute Table” does not contain any information about the record’s shapes.  The only component of the “Attribute Table” that exposes empty or null geometries is when a user selects “Zoom to Feature” for a specific record.  In QGIS version 3.x, a warning message is shown on the map canvas that the shape is empty or doesn’t exist depending on whether the shape is empty or <em>null</em> (<a class="reference internal" href="#figureiii"><span class="std std-numref">Fig. 5</span></a>).</p>
<div class="figure align-center" id="id57">
<span id="figureiii"></span><img alt="_images/FigureII.png" src="_images/FigureII.png" />
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">A warning message is displayed in QGIS when a user attempts to zoom to a record with an empty geometry.</span></p>
</div>
<p>The DB Manager in QGIS 3.x is a core plugin (it can’t be uninstalled).  The DB Manager plugin provides database specific information for data from a limited number of databases that includes PostGIS, but, excludes Microsoft SQL Server.  The Table view within DB Manager shows all of the columns within the table including the geometry attribute.  For the geometry column it gives the geometry type and exposes null shapes as <em>“NULL”</em> (<a class="reference internal" href="#figureiv"><span class="std std-numref">Fig. 6</span></a>).</p>
<div class="figure align-center" id="id58">
<span id="figureiv"></span><img alt="_images/FigureIII.png" src="_images/FigureIII.png" />
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">The output from the DB Manager plugin in QGIS 3.x for a dataset that contains both empty geometry values and null geometry values.</span></p>
</div>
</div>
<div class="section" id="gis-professional-awareness">
<h3>GIS PROFESSIONAL AWARENESS<a class="headerlink" href="#gis-professional-awareness" title="Permalink to this headline">¶</a></h3>
<p>Many GIS professionals are educated and work within GIS dataset schema where both null and empty geometries are excluded.  It is plausible that GIS professionals that are not familiar with null and empty shapes are ignorant of them when using a GIS where they are permitted.  This is a situation that confronted the proponent of this project.  Examples of wrong understanding of null and empty geometry values are widespread on the world wide web.  For example, an article published by esri incorrectly states that an empty geometry exists for any geometry where the coordinates are unknown <a class="reference internal" href="#esrinulloracle" id="id25">[2]</a>.</p>
<p>Micosoft SQL and PostGis both permit null and empty geometry values unless explicitly excluded by constraints or third party software.  Even when a primary dataset contains no null or empty geometry values, processing of that dataset may produce empty null or empty geometry values.  Performing set operations like intersections within the database, and, editing geometry of specific records within QGIS are two ways empty geometry values can be created.</p>
<div class="section" id="set-operations-in-microsoft-sql-or-postgis-can-produce-empty-geometry-values">
<h4>Set operations in Microsoft SQL or PostGIS can produce empty geometry values<a class="headerlink" href="#set-operations-in-microsoft-sql-or-postgis-can-produce-empty-geometry-values" title="Permalink to this headline">¶</a></h4>
<p>There are several fundamental set operations that are used to construct new sets from existing sets regardless to what it is a set of <a class="reference internal" href="#settheoryoverall" id="id26">[16]</a>.  Within a database, a set operation needs to be consistent for all data types.  As introduced in section <span class="xref std std-ref">Records with false Boolean logic</span> some databases generate empty geometry values for set operations.  Microsoft SQL Server and PostGis are examples of databases that can generate empty geometry values for set operations.  Both of these databases developed from SQL conventions and their generation of empty values for geometries is consistent with set operations for other data types.</p>
<p>Intersection of two sets is an example of a set operation.  Intersect refers to those locations where two or more objects meet, cross or cover each other <a class="reference internal" href="#intersectdefinition" id="id27">[10]</a>.  Many different fields that employ set theory, Intersect of two datasets returns all records that exist in both datasets (<a class="reference internal" href="#figurev"><span class="std std-numref">Fig. 7</span></a>).  The intersect concept can be applied to many datatypes including characters, numbers, dates, and, geometries.</p>
<div class="figure align-center" id="id59">
<span id="figurev"></span><img alt="_images/FigureIV.png" src="_images/FigureIV.png" />
<p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">The schematic intersection of Set 1 and Set 2 is purple.</span></p>
</div>
<p>Consider the intersection of the points ‘Pt1’ and ‘Pt2’ with the circle shown in <a class="reference internal" href="#figurevi"><span class="std std-numref">Fig. 8</span></a> which is an example of an intersection between two geometry datasets.  ‘Pt 1’ lies within the circle, and, hence intersects the circle.  ‘Pt2’ lies outside the circle and does not.  In both QGIS v3.x and ArcGIS desktop, the intersection of a points dataset containing ‘Pt1’ and ‘Pt2’ and a dataset containing the circle will return only those records that intersect, hence, only ‘Pt1’ is returned.  In contrast, in Microsoft SQL Server, the intersection returns both the records that do and don’t intersect with a dataset containing both ‘Pt1’ and ‘Pt2’.</p>
<div class="figure align-center" id="id60">
<span id="figurevi"></span><img alt="_images/FigureV.png" src="_images/FigureV.png" />
<p class="caption"><span class="caption-number">Fig. 8 </span><span class="caption-text">A schematic of the intersection of points ‘Pt1’ and ‘Pt2’ with a circle.</span></p>
</div>
<p>There is no error with either the approach to intersection taken by QGIS 3.x and Microsoft SQL Server.  As described in the section <span class="xref std std-ref">Records with false Boolean logic</span> QGIS 3.x includes an addition selection logic step that removes those records that don’t intersect.  For ‘Pt2’, Microsoft SQL server is returning an empty geometry confirming that no intersection exists, as shown by the following Transact-SQL script <a class="footnote-reference" href="#f2" id="id28">[2]</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DECLARE</span> <span class="nd">@circle</span> <span class="n">geometry</span> <span class="o">=</span> <span class="s1">&#39;CURVEPOLYGON (CIRCULARSTRING (0 1, 1 2, 2 1, 1 0, 0 1))&#39;</span><span class="p">;</span>
<span class="n">DECLARE</span> <span class="nd">@Pt2</span> <span class="n">geometry</span> <span class="o">=</span> <span class="s1">&#39;POINT (3 1)&#39;</span><span class="p">;</span>
<span class="n">SELECT</span> <span class="nd">@Pt2</span><span class="o">.</span><span class="n">STIntersection</span><span class="p">(</span><span class="nd">@circle</span><span class="p">)</span><span class="o">.</span><span class="n">ToString</span><span class="p">();</span>
<span class="n">GEOMETRYCOLLECTION</span> <span class="n">EMPTY</span>
</pre></div>
</div>
<p>This intersection example shows the ease with which one can inadvertently generate empty geometry values in Microsoft SQL Server, and, these empty geometry values will be passed to QGIS.</p>
</div>
<div class="section" id="inadvertently-creating-empty-geometries-within-qgis">
<h4>Inadvertently Creating Empty Geometries within QGIS<a class="headerlink" href="#inadvertently-creating-empty-geometries-within-qgis" title="Permalink to this headline">¶</a></h4>
<p>Within QGIS, an empty geometry is created by using the “Vertex Tool” to delete all vertices of an existing shape.  A user unfamiliar with QGIS may incorrectly assume that deleting all the vertices of a shape also deletes the record.  Hence, when editing a shape, a QGIS user may unintentionally create an empty shape when they are attempting to delete the shape.</p>
</div>
</div>
<div class="section" id="retrospective-incorporation-of-empty-and-null-values-into-software">
<h3>Retrospective incorporation of empty and null values into Software<a class="headerlink" href="#retrospective-incorporation-of-empty-and-null-values-into-software" title="Permalink to this headline">¶</a></h3>
<p>The Geospatial Data Abstraction Library (GDAL) is ubiquitous within most GIS Software to translate and process geospatial data.  Handles for empty shapes were not part of the original GDAL specification, with empty shapes being treated as null.   The retrospective incorporation of empty handles into GDAL has not been picked up by many applications that employ GDAL, and, even within GDAL there are many processing tools that do not allow for empty shapes.</p>
<p>Many of the current GDAL set operators continue to convert empty geometry values to null geometry values even when the set being operated on has successfully implemented the empty shape handle on passing to GDAL.  For example, for the Intersection operation the output is <em>“a new geometry representing the intersection or NULL if there is no intersection or an error occurs”</em> <a class="reference internal" href="#gdalintersection" id="id29">[4]</a>.  Curiously, the same GDAL geometry class has a handle to assign an empty geometry, or, to test for an empty geometry <a class="reference internal" href="#gdalempty" id="id30">[1]</a>.  On another GDAL ticket register it is stated <em>“GML/WFS: by default does not advertise NOT NULL fields since we treat empty strings as being null for historical reasons. By setting the open option EMPTY_AS_NULL=NO, empty strings will be reported as such and NOT NULL fields might be advertised”</em> <a class="reference internal" href="#rouault2015" id="id31">[20]</a>, it is clear that GDAL is not originally intended to distinguish between null and empty.</p>
<p>The retrospective addition of handles for empty geometry values in GDAL was mimicked by QGIS.  Consequently, within QGIS there are likely to many set operators that convert empty values to null values as part of the set operation.</p>
<div class="section" id="the-definition-of-null-and-empty-values-depends-on-context">
<h4>The definition of Null and Empty Values depends on context<a class="headerlink" href="#the-definition-of-null-and-empty-values-depends-on-context" title="Permalink to this headline">¶</a></h4>
<p>The definition of Empty geometry values introduced in section 2.2 it was articulated that an Empty geometry is just one valid value in the set of valid values for the geometry data type.  In contrast, null indicates that the geometry value is unknown and that the value can be any value from the set of valid values. Hence, an empty geometry values is one of many possible values for a null geometry (or, empty is a subclass of null).  For example, for a point, the vertices of an empty point are <span class="math notranslate nohighlight">\(\{\ \ \}\)</span> as it has no coordinates, and, the vertices of a null point are <span class="math notranslate nohighlight">\(\{x,y\}\)</span> where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are both variables designating unknown coordinates. These definitions are consistent with SQL relational databases.  Unfortunately, the definition of null used by SQL relational databases is different to that used by both mathematics for set theory, and, but most computer programming languages <a class="reference internal" href="#whatisnull" id="id32">[6]</a>.</p>
<p>Let’s consider the definition of null for set theory and computer programming using a common example.  If one has a box of apples and a box of bananas, then the intersection of the two boxes of fruit is an empty box. For set theory, <em>null</em> – nothing is what you have when you take away the box.</p>
<p>Similar to set theory, for most object-oriented computer programming languages, an object that has not been instantiated is <em>null</em>.  Hence, a pointer to something that doesn’t exist is null. An empty object is an object that has been instantiated but not populated, for example, a list with no members, or, a box with no fruit.</p>
<p>So, from the perspective of an object-oriented computer programming language, null means no value.  Hence, a null object is an object that does not exist, or, occupies no space in a computer’s memory.  Indeed, SQL relational databases implement null as an object that doesn’t exist, so, the context difference between unknown and nothing does not have to create conflict.</p>
<p>The underlying conflict is based on logical deduction.  It has been proved that an empty set is a subset of any set.  It is argued that on object that doesn’t exist can’t contain anything, so, it must be empty <a class="footnote-reference" href="#f3" id="id33">[3]</a>.  Hence, <em>null</em> is a subclass of empty.  However, an empty set is a still a set, a container that is empty.  In contrast, null states that no container exists.  So, by arguing that a <em>null</em> object is empty you have just created an object.  A <em>null</em> object neither contains anything nor has a container.</p>
<p>Unfortunately, QGIS employs the logic that a null geometry is also an empty geometry <a class="reference internal" href="#qgsgeometrysource2018" id="id34">[11]</a>.    The QGIS test for null simply asks where there the object point points to anything <a class="reference internal" href="#qgsgeometrysource2018" id="id35">[11]</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>144 bool QgsGeometry::isNull() const
145 {
146  return !d-&gt;geometry;
147 }
</pre></div>
</div>
<p>Now, the QGIS test for empty performs the same test as for null, and, returns true if the test for null returns true <a class="reference internal" href="#qgsgeometrysource2018" id="id36">[11]</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>329 bool QgsGeometry::isEmpty() const
330 {
331  if ( !d-&gt;geometry )
332  {
333  return true;
334  }
335
336  return d-&gt;geometry-&gt;isEmpty();
337 }
</pre></div>
</div>
<table class="docutils footnote" frame="void" id="f1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id20">[1]</a></td><td>a <code class="docutils literal notranslate"><span class="pre">Point</span> <span class="pre">(nan</span> <span class="pre">nan)</span></code> is also reported when an empty PostGis point is parsed by QGIS.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="f2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id28">[2]</a></td><td>In both Microsoft SQL and PostGis the geometry type that is empty is recorded <a class="reference internal" href="#loskot2010" id="id37">[17]</a><a class="reference internal" href="#ramsey2010" id="id38">[19]</a>).  Sometimes the geometry type gets changed to the generic ‘GEOMETRYCOLLECTION’ by set operations.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="f3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id33">[3]</a></td><td>Unable to find a high quality reference for this argument.  Several private conversations with C++ programers reveal that this logic is common and is frequently used to test for empty in C++.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="f4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[4]</a></td><td>In many QSL databases the hierarchy separates all geometry types that employ cartesian coordinates from those that employ geographic coordinates.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="f5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[5]</a></td><td>For SQL relational databases, the term geometry is restricted to those shapes that are located by cartesian coordinates.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="f6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[6]</a></td><td>Python uses <em>None</em> instead of <em>null</em>, but, PyQT uses <em>NULL</em> as a QVariant, so, PyQGIS script may have a mixture of <em>None</em> and <em>NULL</em> depending on the origin of the classes in use.</td></tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="future-development">
<h2>Future Development<a class="headerlink" href="#future-development" title="Permalink to this headline">¶</a></h2>
<p>Some ideas for improvement:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Add a summary table</li>
<li>Add a column for number of parts</li>
<li>Distinguish curved shapes</li>
<li>Distinguish shapes with elevation information</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="bibliography">
<h2>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-concept-0"><table class="docutils citation" frame="void" id="gdalempty" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id30">[1]</a></td><td>Empty(self, *args). URL: <a class="reference external" href="http://gdal.org/python/osgeo.ogr.Geometry-class.html#Empty">http://gdal.org/python/osgeo.ogr.Geometry-class.html#Empty</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="esrinulloracle" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id25">[2]</a></td><td>How To : Insert a NULL or empty st _ geometry attribute in Oracle. URL: <a class="reference external" href="https://support.esri.com/en/technical-article/000010466">https://support.esri.com/en/technical-article/000010466</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="id39" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id12">2</a>)</em> QGIS - The Leading Open Source Desktop GIS. URL: <a class="reference external" href="https://www.qgis.org/en/site/about/index.html#">https://www.qgis.org/en/site/about/index.html#</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gdalintersection" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id29">[4]</a></td><td>def Intersection(self, *args):. URL: <a class="reference external" href="http://gdal.org/python/osgeo.ogr-pysrc.html#Geometry.Intersection">http://gdal.org/python/osgeo.ogr-pysrc.html#Geometry.Intersection</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="iso19125-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[5]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id4">2</a>, <a class="fn-backref" href="#id8">3</a>, <a class="fn-backref" href="#id9">4</a>)</em> ISO 19125-2 Geographic information - Simple feature access. Part 2: SQL Option. First Edition. 2004.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="whatisnull" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id32">[6]</a></td><td>What Is Null. 2010. URL: <a class="reference external" href="http://wiki.c2.com/?WhatIsNull">http://wiki.c2.com/?WhatIsNull</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="qgsgeometryclass" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id18">[7]</a></td><td>QgsGeometry Class Reference. 2017. URL: <a class="reference external" href="https://qgis.org/api/2.18/classQgsGeometry.html#details">https://qgis.org/api/2.18/classQgsGeometry.html#details</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="qgspointbugreport2018" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id19">[8]</a></td><td>Bug report #19190: QgsPoint class does not store empty point geometries - QGIS Application - QGIS Issue Tracking. 2018. URL: <a class="reference external" href="https://issues.qgis.org/issues/19190">https://issues.qgis.org/issues/19190</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="qgischangelogv3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id17">[9]</a></td><td>Changelog for QGIS 3.0. 2018. URL: <a class="reference external" href="https://www.qgis.org/en/site/forusers/visualchangelog30/">https://www.qgis.org/en/site/forusers/visualchangelog30/</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="intersectdefinition" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id27">[10]</a></td><td>INTERSECT | meaning in the Cambridge English Dictionary. 2018. URL: <a class="reference external" href="https://dictionary.cambridge.org/dictionary/english/intersect">https://dictionary.cambridge.org/dictionary/english/intersect</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="qgsgeometrysource2018" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[11]</td><td><em>(<a class="fn-backref" href="#id34">1</a>, <a class="fn-backref" href="#id35">2</a>, <a class="fn-backref" href="#id36">3</a>)</em> QGIS API Documentation: /tmp/buildd/qgis-3.3.0+git20180710+2688a9d+15buster/src/core/geometry/qgsgeometry.cpp Source File. 2018. URL: <a class="reference external" href="https://qgis.org/api/qgsgeometry_8cpp_source.html">https://qgis.org/api/qgsgeometry_8cpp_source.html</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="qgsabstractgeometry" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[12]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id11">2</a>)</em> QGIS API Documentation: QgsAbstractGeometry Class Reference. 2018. URL: <a class="reference external" href="https://qgis.org/api/classQgsAbstractGeometry.html">https://qgis.org/api/classQgsAbstractGeometry.html</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="qgsproviders2018" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[13]</td><td><em>(<a class="fn-backref" href="#id22">1</a>, <a class="fn-backref" href="#id23">2</a>)</em> QGIS/src/providers/. 2018. URL: <a class="reference external" href="https://github.com/qgis/QGIS/tree/master/src/providers">https://github.com/qgis/QGIS/tree/master/src/providers</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="arcgistutorialforempty" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id24">[14]</a></td><td>Tutorial: Perform web editing using data from a database—Documentation | ArcGIS Enterprise. 2018. URL: <a class="reference external" href="http://enterprise.arcgis.com/en/server/latest/get-started/windows/tutorial-performing-web-editing-using-data-from-a-database.htm">http://enterprise.arcgis.com/en/server/latest/get-started/windows/tutorial-performing-web-editing-using-data-from-a-database.htm</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="qgiscontributors" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[15]</td><td><em>(<a class="fn-backref" href="#id13">1</a>, <a class="fn-backref" href="#id15">2</a>, <a class="fn-backref" href="#id16">3</a>)</em> Wikipeday Contributors. QGIS. URL: <a class="reference external" href="https://en.wikipedia.org/wiki/QGIS">https://en.wikipedia.org/wiki/QGIS</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="settheoryoverall" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id26">[16]</a></td><td>Wikipedia Contributors. Set (mathematics). 2018. URL: <a class="reference external" href="https://en.wikipedia.org/w/index.php?title=Set_(mathematics)&amp;oldid=866126059">https://en.wikipedia.org/w/index.php?title=Set_(mathematics)&amp;oldid=866126059</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="loskot2010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id37">[17]</a></td><td>Mateusz Loskot. SqlGeometry and POINT EMPTY in WKB. 2010. URL: <a class="reference external" href="http://mateusz.loskot.net/post/2010/02/26/sqlgeometry-and-point-empty-in-wkb/">http://mateusz.loskot.net/post/2010/02/26/sqlgeometry-and-point-empty-in-wkb/</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="ogc2010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[18]</a></td><td>OGC. OpenGIS\textregistered  Implementation Standard for Geographic information - Simple feature access - Part 1: Common architecture. <em>Open Geospatial Consortium, Inc</em>, pages 93, 2010. URL: <a class="reference external" href="http://portal.opengeospatial.org/files/?artifact_id=25355E+Implementation+Standard+for+Geographic+information+-+Simple+feature+access#1">http://portal.opengeospatial.org/files/?artifact_id=25355E+Implementation+Standard+for+Geographic+information+-+Simple+feature+access#1</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="ramsey2010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id38">[19]</a></td><td>Paul Ramsey. Nothing, Nada, Zip, Bupkus. 2010. URL: <a class="reference external" href="http://blog.cleverelephant.ca/2010/03/nothing-nada-zip-bupkus.html">http://blog.cleverelephant.ca/2010/03/nothing-nada-zip-bupkus.html</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="rouault2015" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id31">[20]</a></td><td>Even Rouault. Empty elements in GML : empty or NULL. 2015. URL: <a class="reference external" href="https://trac.osgeo.org/gdal/ticket/5968">https://trac.osgeo.org/gdal/ticket/5968</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="garysherman2011" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id14">[21]</a></td><td>Gary Sherman. History of QGIS Committers. 2011. URL: <a class="reference external" href="http://spatialgalaxy.net/2011/09/23/history-of-qgis-committers/">http://spatialgalaxy.net/2011/09/23/history-of-qgis-committers/</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="parseemptyfromsql" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id21">[22]</a></td><td>Philip Whitten. Bug report #19397: Parssing of empty geometry values from MicroSoft SQL Server - QGIS Application - QGIS Issue Tracking. 2018. URL: <a class="reference external" href="https://issues.qgis.org/issues/19397">https://issues.qgis.org/issues/19397</a>.</td></tr>
</tbody>
</table>
</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="changelog.html" class="btn btn-neutral float-right" title="Changelog" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="API.html" class="btn btn-neutral" title="API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Philip Whitten

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>